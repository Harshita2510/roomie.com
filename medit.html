<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Mess Profile</title>
    <link rel="stylesheet" href="medit.css">
</head>

<body>
    <div class="container">
        <div class="profile-image-section">
            <div class="profile-image-wrapper">
                <img src="" alt="Profile Image" class="profile-image" id="profileImg">
                <label for="image" class="image-upload-label">
                    Upload Profile Picture
                    <input type="file" class="image-upload" id="image" accept="image/*">
                </label>
            </div>
        </div>

        <div class="form-section">
            <h2>Edit Mess Profile</h2>
            <form id="registerationForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="name">Name</label>
                        <input type="text" id="name" name="name" required placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label for="contact">Contact Number</label>
                        <input type="text" id="contact" name="contact" required placeholder="Enter your contact number">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="email">Mess Time</label>
                        <input type="text" id="email" name="time" placeholder="Enter mess time">
                    </div>
                    <div class="form-group">
                        <label for="messName">Mess Menu</label>
                        <input type="text" id="messName" name="course" placeholder="Enter your mess menu">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="address">Mess Address</label>
                        <input type="text" id="address" name="course" placeholder="Enter your mess address">
                    </div>
                    <div class="form-group">
                        <label for="type">Mess Type</label>
                        <select id="type" name="type">
                            <option>Veg</option>
                            <option>Non-Veg</option>
                            <option>Vegan</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="cost">Monthly Cost</label>
                        <input type="number" id="cost" name="cost" placeholder="Enter cost of mess">

                    </div>
                    <div class="form-group full-width">
                        <label for="description">Additional Note</label>
                        <textarea id="description" name="description"
                            placeholder="Add information about your mess"></textarea>
                    </div>
                </div>

                <button type="submit">Edit Profile</button>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            document.getElementById("image").addEventListener("change", function (event) {
                const image = document.getElementById("profileImg");
                const file = event.target.files[0];
    
                if (file) {
                    const reader = new FileReader();
    
                    reader.onload = function (e) {
                        image.src = e.target.result;
                    };
    
                    reader.readAsDataURL(file);
                }
            });
    
            document.getElementById("registerationForm").addEventListener("submit", async function (event) {
                event.preventDefault();
    
                const formData = {
                    messname: document.getElementById("name").value, // Changed 'name' to 'messname' for consistency
                    mobile: document.getElementById("contact").value,
                    time: document.getElementById("email").value,
                    menu: document.getElementById("messName").value,
                    address: document.getElementById("address").value,
                    type: document.getElementById("type").value,
                    cost: document.getElementById("cost").value,
                    description: document.getElementById("description").value
                };
    
                try {
                    const response = await fetch("http://localhost:3019/edit-mess", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(formData)
                    });
    
                    const result = await response.json();
                    if (response.ok) {
                        alert(result.message);
                        window.location.reload(); // Refresh page on successful update
                    } else {
                        alert(result.error);
                    }
                } catch (error) {
                    console.error("‚ùå Error submitting form:", error);
                    alert("Server error. Please try again.");
                }
            });
        });
    </script>
    

    <!-- <script>
        document.addEventListener("DOMContentLoaded", function () {
            document.getElementById("image").addEventListener("change", function (event) {
                const image = document.getElementById("profileImg");
                const file = event.target.files[0];

                if (file) {
                    const reader = new FileReader();

                    reader.onload = function (e) {
                        image.src = e.target.result;
                    };

                    reader.readAsDataURL(file);
                }
            });

            document.getElementById("roommateForm").addEventListener("submit", async function (event) {
                event.preventDefault();

                // const formData = {
                //     name: document.getElementById("name").value,
                //     gender: document.getElementById("gender").value,
                //     hobby: document.getElementById("hobby").value,
                //     course: document.getElementById("course").value,
                //     food: document.getElementById("food").value,
                //     bhk: document.getElementById("bhk").value,
                //     type: document.getElementById("type").value,
                //     note: document.getElementById("note").value
                // };

                const formData = {
                    name: document.getElementById("name").value,
                    contact: document.getElementById("contact").value,
                    time: document.getElementById("email").value,
                    menu: document.getElementById("messName").value,
                    address: document.getElementById("address").value,
                    type: document.getElementById("type").value,
                    cost: document.getElementById("cost").value,
                    description: document.getElementById("description").value
                };


                try {
                    const response = await fetch("http://localhost:3019/edit-mess", {

                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(formData)
                    });

                    const result = await response.json();
                    alert(result.message);
                } catch (error) {
                    console.error("Error submitting form:", error);
                }
            });
        });

    </script> -->


</body>

</html>